clear;clf;clc;close all 
%SAMPLE PES=fillinviasymmetry(diffusionPES('17_1vasp.dat'),'c3v'); 
%SAMPLE NameofPESdata='PESFull_Au18_1.mat'; 
load(NameofPESdata); 
XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.648950000000
      2.447587827626      0.000000000000      1.030339543326
      2.567635928979      1.647191104187      3.229109258311
      0.479910766054      1.147428794872      5.077467228213
     -0.020582376698     -1.547040463711      4.866709426199
      2.481950774754     -1.301871858011      3.510189024382
      4.742278172244      0.004500564567      2.413088784986
      4.839910209462      1.809255172718      4.797758463110
      6.897628908690      0.199840755861      4.060345372609
      4.764175932682     -1.064859560992      5.160610252224
      2.539231920438     -2.185846388083      6.139960811253
      0.165351446790     -3.158438664617      7.027057352820
      3.019140384148      0.549021780009      6.597010065793
      0.578274827018     -0.490012922474      7.508417394681
      0.936097633807      2.218836889402      7.549307593667
      2.589011724372      3.171065065394      5.538748278436
      2.236015419746      1.282224525134     -0.157385809387
     -0.789762189492     -0.020182070551     -1.561527567035
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=1;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=18;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.648950000000
      2.447587827626      0.000000000000      1.030339543326
      2.567635928979      1.647191104187      3.229109258311
      0.479910766054      1.147428794872      5.077467228213
     -0.020582376698     -1.547040463711      4.866709426199
      2.481950774754     -1.301871858011      3.510189024382
      4.742278172244      0.004500564567      2.413088784986
      4.839910209462      1.809255172718      4.797758463110
      6.897628908690      0.199840755861      4.060345372609
      4.764175932682     -1.064859560992      5.160610252224
      2.539231920438     -2.185846388083      6.139960811253
      0.165351446790     -3.158438664617      7.027057352820
      3.019140384148      0.549021780009      6.597010065793
      0.578274827018     -0.490012922474      7.508417394681
      0.936097633807      2.218836889402      7.549307593667
      2.589011724372      3.171065065394      5.538748278436
      2.693839544805      1.863310858119      1.485899415854
     -0.789762189492     -0.020182070551     -1.561527567035
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=1; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=18;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 


PES.plotContourWithAtomRegions(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2,1)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')