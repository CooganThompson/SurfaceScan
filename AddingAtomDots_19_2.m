clear;clf;clc;close all 
%SAMPLE PES=fillinviasymmetry(diffusionPES('17_1vasp.dat'),'c3v'); 
%SAMPLE NameofPESdata='PESFull_Au18_1.mat'; 
load(NameofPESdata); 
XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.774890000000
      2.435732011137      0.000000000000      1.432466265859
      1.955779116957     -1.744986425773     -0.761047086876
      0.002895918411     -2.454602125296      1.207064594689
      2.312251769704     -0.129863108607      4.214072944947
      0.620274332415     -2.419177195070      3.907637309714
      2.425306454929     -2.350910735448      6.009151098411
      1.798684604504     -4.731652048054      4.911854921265
      0.320115977144     -4.793231174081      2.453237106428
      1.350303166075     -7.060815145437      3.518612559032
      3.328194683931     -5.426567420525      2.629163422089
      2.071278272254     -4.242303144643      0.435141136197
      4.648561376071     -3.414146830723      1.439422619213
      4.100704357725     -3.450918407568     -1.261386417849
      4.588159767589     -1.031426631222      0.048784892412
      4.697105861628     -0.857526474712      2.754414421565
      4.195669073015     -3.250164722981      4.099824232747
      4.663611336516     -0.793583026610      5.483690679152
      1.898712545702     -0.013946467471     -1.183180678022
     -0.992338213944      1.049846120880     -0.987718578130
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=1;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=20;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.774890000000
      2.435732011137      0.000000000000      1.432466265859
      1.955779116957     -1.744986425773     -0.761047086876
      0.002895918411     -2.454602125296      1.207064594689
      2.312251769704     -0.129863108607      4.214072944947
      0.620274332415     -2.419177195070      3.907637309714
      2.425306454929     -2.350910735448      6.009151098411
      1.798684604504     -4.731652048054      4.911854921265
      0.320115977144     -4.793231174081      2.453237106428
      1.350303166075     -7.060815145437      3.518612559032
      3.328194683931     -5.426567420525      2.629163422089
      2.071278272254     -4.242303144643      0.435141136197
      4.648561376071     -3.414146830723      1.439422619213
      4.100704357725     -3.450918407568     -1.261386417849
      4.588159767589     -1.031426631222      0.048784892412
      4.697105861628     -0.857526474712      2.754414421565
      4.195669073015     -3.250164722981      4.099824232747
      4.663611336516     -0.793583026610      5.483690679152
      3.027588953656     -0.216063163270     -0.305537242572
     -0.992338213944      1.049846120880     -0.987718578130
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=1; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=20;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 


PES.plotContourWithAtomRegions(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2,1)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')