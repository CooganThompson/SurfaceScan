clear;clf;clc;close all 
%SAMPLE PES=fillinviasymmetry(diffusionPES('17_1vasp.dat'),'c3v'); 
%SAMPLE NameofPESdata='PESFull_Au18_1.mat'; 
load(NameofPESdata); 
XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.818960000000
      2.449080012762      0.000000000000      1.420138927249
      1.749146552046     -2.179215678681     -0.195485668151
     -0.809205525374     -2.186816914747     -1.390751199597
     -1.086883095480     -2.172852034319      1.412947926894
     -0.802759485461     -2.184137623405      4.223603931902
      1.753505473261     -2.190820486280      3.026051047196
      4.067666164358     -2.184163019547      1.416122112125
      3.226133097752     -4.572490389140     -0.075391405434
      0.898921613466     -4.573008025903     -1.403004110369
     -1.528363398365     -4.513191069971     -2.613744151547
     -1.651151553758     -4.589225799072      0.090920814954
     -1.633382449590     -4.582957382279      2.765981119869
     -1.475679752708     -4.502886779208      5.473716073267
      0.920586890393     -4.588645456512      4.223112410429
      3.230279913647     -4.588924229608      2.870162150710
      5.507721866783     -4.498737956852      1.390467373465
      0.832006780001     -4.802017825380      1.408536857221
      0.835774283816     -5.925278688027      3.033434235909
      0.840611943471     -6.551989481229      1.403521343919
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=19;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=20;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.818960000000
      2.449080012762      0.000000000000      1.420138927249
      1.749146552046     -2.179215678681     -0.195485668151
     -0.809205525374     -2.186816914747     -1.390751199597
     -1.086883095480     -2.172852034319      1.412947926894
     -0.802759485461     -2.184137623405      4.223603931902
      1.753505473261     -2.190820486280      3.026051047196
      4.067666164358     -2.184163019547      1.416122112125
      3.226133097752     -4.572490389140     -0.075391405434
      0.898921613466     -4.573008025903     -1.403004110369
     -1.528363398365     -4.513191069971     -2.613744151547
     -1.651151553758     -4.589225799072      0.090920814954
     -1.633382449590     -4.582957382279      2.765981119869
     -1.475679752708     -4.502886779208      5.473716073267
      0.920586890393     -4.588645456512      4.223112410429
      3.230279913647     -4.588924229608      2.870162150710
      5.507721866783     -4.498737956852      1.390467373465
      0.832006780001     -4.802017825380      1.408536857221
      1.637490382815     -6.203254601515      4.397795889105
      0.840611943471     -6.551989481229      1.403521343919
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=19; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=20;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 


PES.plotContourWithAtomRegions(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2,1)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')