clear;clf;clc;close all 
PES=fillinviasymmetry(diffusionPES('18_1vasp.dat'),'c2v'); 
NameofPESdata='data/PESFull_Au18_1.mat'; 
load(NameofPESdata); 

XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.764430000000
      2.464299404850      0.000000000000     -1.314266115693
      0.827696857919     -2.318176225982     -1.318610200055
      0.473554465487     -2.431936276632      1.380022437099
      2.452721687326      0.368199971971      1.385740087524
      0.818229744391     -2.322896549136      4.079671372336
      2.458641393691     -0.008408731951      4.084883074608
      1.693090061153     -4.555084798092      2.890395895301
      1.696461376491     -4.556115059098     -0.135112050961
      3.548877154502     -2.505367842957     -0.492052804818
      4.861152880232     -0.075591586591     -0.125735265293
      4.858581690646     -0.082380259796      2.904557465201
      2.419519044545     -6.672141296414      1.379662019133
      4.133792982695     -4.541222089844      1.381030220026
      5.658028843329     -2.385571778853      1.388619026411
      7.095181657221     -0.061749432441      1.390728661347
      3.546403133107     -2.512266990851      3.266694178740
      0.886055844816      1.501529628687      2.388491334961
     -0.905090921893      0.640251658671      1.381647117637
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=20;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=19;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.764430000000
      2.464299404850      0.000000000000     -1.314266115693
      0.827696857919     -2.318176225982     -1.318610200055
      0.473554465487     -2.431936276632      1.380022437099
      2.452721687326      0.368199971971      1.385740087524
      0.818229744391     -2.322896549136      4.079671372336
      2.458641393691     -0.008408731951      4.084883074608
      1.693090061153     -4.555084798092      2.890395895301
      1.696461376491     -4.556115059098     -0.135112050961
      3.548877154502     -2.505367842957     -0.492052804818
      4.861152880232     -0.075591586591     -0.125735265293
      4.858581690646     -0.082380259796      2.904557465201
      2.419519044545     -6.672141296414      1.379662019133
      4.133792982695     -4.541222089844      1.381030220026
      5.658028843329     -2.385571778853      1.388619026411
      7.095181657221     -0.061749432441      1.390728661347
      3.546403133107     -2.512266990851      3.266694178740
      1.555014030667      1.369329917867      3.403894706758
     -0.905090921893      0.640251658671      1.381647117637
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=20; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=19;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 

PES.plotContourMapsView
PES.plotAtomRegionsOverlay(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2);
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')