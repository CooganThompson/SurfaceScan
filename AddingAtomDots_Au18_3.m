clear;clf;clc;close all 
%SAMPLE PES=fillinviasymmetry(diffusionPES('17_1vasp.dat'),'c3v'); 
%SAMPLE NameofPESdata='PESFull_Au18_1.mat'; 
load(NameofPESdata); 
XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.782670000000
      2.408859437250      0.000000000000      1.270531110864
      1.749286681900     -2.115482748494     -0.554502556758
     -0.207595161922     -2.410942957458      1.401846615265
     -0.026498028054     -2.262373302115      4.314322129327
     -0.207479313736     -4.682109626029      2.869373198244
      2.045132744634     -4.044876551504      1.440746977387
      4.102757287175     -2.275051777383      0.820609624550
      2.370687102265     -0.882340935912      3.933732796440
      4.687055195814     -0.106054075658      2.623515524224
      6.865134833902     -0.694230951147      4.121726162214
      4.687045587520     -2.202034179250      4.666279780716
      6.359512784730     -2.619187810267      2.251527614143
      4.405824416022     -4.402974953352      2.767015597487
      2.374631468495     -3.202661812267      5.440625082813
      0.126299608336     -4.715531424700      5.636746615666
      2.230573773644     -5.519561425565      3.861585977577
      1.305926916826      1.273485658728      1.236209457583
     -0.923309565791      0.884889985317     -1.042578129911
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=1;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=19;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.782670000000
      2.408859437250      0.000000000000      1.270531110864
      1.749286681900     -2.115482748494     -0.554502556758
     -0.207595161922     -2.410942957458      1.401846615265
     -0.026498028054     -2.262373302115      4.314322129327
     -0.207479313736     -4.682109626029      2.869373198244
      2.045132744634     -4.044876551504      1.440746977387
      4.102757287175     -2.275051777383      0.820609624550
      2.370687102265     -0.882340935912      3.933732796440
      4.687055195814     -0.106054075658      2.623515524224
      6.865134833902     -0.694230951147      4.121726162214
      4.687045587520     -2.202034179250      4.666279780716
      6.359512784730     -2.619187810267      2.251527614143
      4.405824416022     -4.402974953352      2.767015597487
      2.374631468495     -3.202661812267      5.440625082813
      0.126299608336     -4.715531424700      5.636746615666
      2.230573773644     -5.519561425565      3.861585977577
      1.583189380642      1.040312329399      2.471829238820
     -0.923309565791      0.884889985317     -1.042578129911
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=1; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=19;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 


PES.plotContourWithAtomRegions(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2,1)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')