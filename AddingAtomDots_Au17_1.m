clear;clf;clc;close all 
%SAMPLE PES=fillinviasymmetry(diffusionPES('17_1vasp.dat'),'c3v'); 
%SAMPLE NameofPESdata='PESFull_Au18_1.mat'; 
load(NameofPESdata); 
XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.928100000000
      2.490403343222      0.000000000000      1.433028848616
      0.815797369795      2.128555353014      1.467764354585
     -0.774590562277     -2.223196614166     -1.235286381570
     -1.340683929604     -2.039924640928      1.477258704671
     -0.745336698109     -2.224547198458      4.187690105317
      1.916562996043     -2.028923798126      3.350086284938
      3.961072907105     -2.213703431561      1.459536870551
      1.914251438297     -2.026944848420     -0.455110995845
      0.812313874640     -4.515383041517     -1.272650975240
     -1.617626564163     -4.508661833259      0.122576161635
     -1.593155885115     -4.523615746888      2.853225572733
      0.834726771695     -4.525175257799      4.224722595365
      3.199368529338     -4.487681501461      2.877629416574
      3.174037414292     -4.492886132575      0.066148308984
      0.803059432475     -4.925591986424      1.477479813546
      2.762032191190      1.340618746746      2.538031039086
      0.816308194092      3.878555261348      1.467533706457
]; 
XYZDirectlyFromZMatConfig1.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ];
XYZDirectlyFromZMatConfig1.AtomLinkedToCOMforZAxisAlignmentIdx=4;
XYZDirectlyFromZMatConfig1.ScanningAtomIdx=18;
XYZDirectlyFromZMatConfig1.OwnAlphaBeta=sphericalPESCoords([30 30]);
XYZDirectlyFromZMatConfig1.COM=mean(XYZDirectlyFromZMatConfig1.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig1.MetalAtomsIdx,:),1); 

XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT=[ 
      0.000000000000      0.000000000000      0.000000000000
      0.000000000000      0.000000000000      2.928100000000
      2.490403343222      0.000000000000      1.433028848616
      0.815797369795      2.128555353014      1.467764354585
     -0.774590562277     -2.223196614166     -1.235286381570
     -1.340683929604     -2.039924640928      1.477258704671
     -0.745336698109     -2.224547198458      4.187690105317
      1.916562996043     -2.028923798126      3.350086284938
      3.961072907105     -2.213703431561      1.459536870551
      1.914251438297     -2.026944848420     -0.455110995845
      0.812313874640     -4.515383041517     -1.272650975240
     -1.617626564163     -4.508661833259      0.122576161635
     -1.593155885115     -4.523615746888      2.853225572733
      0.834726771695     -4.525175257799      4.224722595365
      3.199368529338     -4.487681501461      2.877629416574
      3.174037414292     -4.492886132575      0.066148308984
      0.803059432475     -4.925591986424      1.477479813546
      2.645681938130      0.029564110483      3.223451002167
      0.816308194092      3.878555261348      1.467533706457
];
XYZDirectlyFromZMatConfig2.MetalAtomsIdx=[1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 ];
XYZDirectlyFromZMatConfig2.AtomLinkedToCOMforZAxisAlignmentIdx=4; 
XYZDirectlyFromZMatConfig2.ScanningAtomIdx=18;
XYZDirectlyFromZMatConfig2.OwnAlphaBeta=sphericalPESCoords([45 45]);
XYZDirectlyFromZMatConfig2.COM=mean(XYZDirectlyFromZMatConfig2.XYZDirectlyFromZMAT(XYZDirectlyFromZMatConfig2.MetalAtomsIdx,:),1); 


PES.plotContourWithAtomRegions(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2,1)
PES.plot3DRepresentation(XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2)
PESFull.AlignmentData={XYZDirectlyFromZMatConfig1,XYZDirectlyFromZMatConfig2};
save(NameofPESdata,'PESFull')